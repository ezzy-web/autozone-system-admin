// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model Make {
  id    BigInt  @id @default(autoincrement())
  name  String  @unique
  Model Model[]
}

model Model {
  id      BigInt    @id @default(autoincrement())
  name    String
  make    Make      @relation(fields: [make_id], references: [id])
  make_id BigInt
  Vehicle Vehicle[]
}

model Vehicle {
  id      BigInt @id @default(autoincrement())
  chassis String @unique

  model         Model  @relation(fields: [model_id], references: [id])
  model_id      BigInt
  engine_number String @unique

  is_available Boolean @default(true)
  is_featured  Boolean @default(false)
  is_visible   Boolean @default(false)

  price           Float?
  submodel        String?
  price_condition PriceCondition @default(NEGOTIABLE)
  mileage         Int?
  engine_size     Int?

  body  BodyType
  color String?

  history History   @default(IMPORTED)
  Invoice Invoice[]
  Request Request[]
  features Feature[]
}

model Feature {
  id        BigInt   @id @default(autoincrement())
  title     String
  feature   String
  Vehicle   Vehicle? @relation(fields: [vehicleId], references: [id])
  vehicleId BigInt?
}

model Client {
  id         BigInt    @id @default(autoincrement())
  first_name String
  last_name  String
  mobile     String?
  email      String    @unique
  Invoice    Invoice[]
  Request    Request[]
}

model Invoice {
  id BigInt @id @default(autoincrement())

  client    Client @relation(fields: [client_id], references: [id])
  client_id BigInt

  vehicle    Vehicle @relation(fields: [vehicle_id], references: [id])
  vehicle_id BigInt
}

model Request {
  id Int @id @default(autoincrement())

  client    Client @relation(fields: [client_id], references: [id])
  client_id BigInt

  vehicle    Vehicle @relation(fields: [vehicle_id], references: [id])
  vehicle_id BigInt

  comment String      @default("")
  type    RequestType @default(INFORMATION)
}

enum PriceCondition {
  NEGOTIABLE
  NON_NEGOTIABLE
}

enum BodyType {
  SEDAN
  COUPE
  SUV
  PICKUP
  TRUCK
  VAN
  BUS
}

enum History {
  IMPORTED
  PRE_OWNED
}

enum RequestType {
  PRICE
  VEHICLE
  INFORMATION
}
